unit Data;

interface

uses
  SysUtils, Classes, DB, MemDS, DBAccess, MyAccess;

type
  TPayrollData = class(TDataModule)
    MyConnection1: TMyConnection;
    Users: TMyQuery;
    dsUsers: TDataSource;
    Company: TMyQuery;
    dsCompany: TDataSource;
    DI: TMyQuery;
    dsDI: TDataSource;
    DISched: TMyQuery;
    dsDISched: TDataSource;
    Loans: TMyQuery;
    dsLoans: TDataSource;
    Tax: TMyQuery;
    dsTax: TDataSource;
    TaxSched: TMyQuery;
    dsTaxSched: TDataSource;
    PayrollMaster: TMyQuery;
    dsPayrollMaster: TDataSource;
    Employee: TMyQuery;
    dsEmployee: TDataSource;
    Emp201: TMyQuery;
    dsEmp201: TDataSource;
    PMDeduction: TMyQuery;
    dsPMDeduction: TDataSource;
    EmpLeave: TMyQuery;
    dsEmpLeave: TDataSource;
    Dept: TMyQuery;
    dsDepartment: TDataSource;
    Accountchart: TMyQuery;
    dsAccountChart: TDataSource;
    DepartmentEntry: TMyTable;
    DescriptionListing: TMyQuery;
    Rank: TMyTable;
    NR3001dk: TMyQuery;
    NR3001dklastname: TStringField;
    NR3001dkfirstname: TStringField;
    NR3001dkmiddlename: TStringField;
    NR3001dksssnumber: TStringField;
    NR3001dkSSSContribution: TFloatField;
    NR3001dkCompensation: TFloatField;
    PayrollYear: TMyQuery;
    DIiddeductionindex: TLongWordField;
    DIdescription: TStringField;
    DIOtherSpec: TStringField;
    DIAcode: TStringField;
    DISchediddeductionschedule: TLongWordField;
    DIScheddeductionindex: TFloatField;
    DIScheddescription: TStringField;
    DISchedrangefrom: TFloatField;
    DISchedrangeto: TFloatField;
    DISchedemployeecontribution: TFloatField;
    DISchedemployercontribution: TFloatField;
    DISchedemployeecompensation: TFloatField;
    DISchedOtherRepRef: TFloatField;
    Loansidloanschedule: TLongWordField;
    Loansidemployee: TFloatField;
    Loansempnumber: TStringField;
    LoansName: TStringField;
    Loansdescription: TStringField;
    Loansdatereleased: TDateField;
    Loansprincipal: TFloatField;
    Loansinterest: TFloatField;
    Loanstotalloan: TFloatField;
    Loansmonths: TLongWordField;
    Loansmonthlydeduction: TFloatField;
    Loanstotalpayment: TFloatField;
    Loansloanstatus: TStringField;
    Employeeidemployee: TLongWordField;
    Employeeempnumber: TStringField;
    Employeebionumber: TStringField;
    Employeedateemployed: TDateTimeField;
    EmployeeBDay: TDateField;
    Employeesssnumber: TStringField;
    Employeetin: TStringField;
    EmployeePagibigNo: TStringField;
    EmployeePhilhealthId: TStringField;
    Employeedeptcode: TStringField;
    Employeefirstname: TStringField;
    Employeemiddleinitial: TStringField;
    Employeelastname: TStringField;
    Employeemiddlename: TStringField;
    Employeeaddress: TStringField;
    Employeetitle: TStringField;
    Employeerank: TStringField;
    Employeebasicpay: TFloatField;
    Employeemonthlyleave: TFloatField;
    Employeewtaxstatus: TStringField;
    Employeeemppicture: TBlobField;
    Employeedepartmentname: TStringField;
    EmployeeDailyRate: TFloatField;
    Employeeemployeestatus: TStringField;
    EmployeeFBSickLeave: TFloatField;
    EmployeeFBVacationLeave: TFloatField;
    Employeedependents: TMemoField;
    EmployeeisFlexiTime: TBooleanField;
    UsersUserPassWord: TStringField;
    UsersUserName: TStringField;
    UsersUserID: TStringField;
    UsersUserPic: TBlobField;
    UsersPosition: TStringField;
    UsersUserRestriction: TStringField;
    UsersIdUsers: TLongWordField;
    PayrollMasteridpayrollmaster: TLongWordField;
    PayrollMasteridemployee: TFloatField;
    PayrollMasterpaymonth: TDateField;
    PayrollMasterdescription: TStringField;
    PayrollMasterempnumber: TStringField;
    PayrollMastername: TStringField;
    PayrollMasterdeptcode: TStringField;
    PayrollMasterbasicpay: TFloatField;
    PayrollMasterDifferential: TFloatField;
    PayrollMasterUnpaidAmt: TFloatField;
    PayrollMasterNumUnpaidDays: TFloatField;
    PayrollMasterUnpaidRate: TFloatField;
    PayrollMasterpremiumpay: TFloatField;
    PayrollMasterRegOtPay: TFloatField;
    PayrollMasterSpcOTPay: TFloatField;
    PayrollMasterRestOtPay: TFloatField;
    PayrollMasterRestOtExPay: TFloatField;
    PayrollMasterLegOTPay: TFloatField;
    PayrollMasterLegOtExPay: TFloatField;
    PayrollMasterLegRestOtPay: TFloatField;
    PayrollMasterSpcOtExPay: TFloatField;
    PayrollMasternsd: TFloatField;
    PayrollMasterundertime: TFloatField;
    PayrollMasterabsences: TFloatField;
    PayrollMasterriceallowance: TFloatField;
    PayrollMasterhazard: TFloatField;
    PayrollMasterlighting: TFloatField;
    PayrollMasterMonth13: TFloatField;
    PayrollMasterBonus: TFloatField;
    PayrollMasterOtherPay: TFloatField;
    PayrollMasterPAGIBIGCont: TFloatField;
    PayrollMasterSSSCont: TFloatField;
    PayrollMasterPhilHealth: TFloatField;
    PayrollMasterWTax: TFloatField;
    PayrollMasterOtherDeduction: TFloatField;
    PayrollMasternetpay: TFloatField;
    PayrollMasterpaycode: TLongWordField;
    PayrollMasterwtaxstatus: TStringField;
    PayrollMastertaxable: TFloatField;
    PayrollMasterRegOtHrs: TFloatField;
    PayrollMasterSpcOTHrs: TFloatField;
    PayrollMasterRestOtHrs: TFloatField;
    PayrollMasterRestOtExHrs: TFloatField;
    PayrollMasterLegOTHrs: TFloatField;
    PayrollMasterLegOtExHrs: TFloatField;
    PayrollMasterLegRestOtExPay: TFloatField;
    PayrollMasterLegRestOtHrs: TFloatField;
    PayrollMasterLegRestOtExHrs: TFloatField;
    PayrollMasterSpcOtExHrs: TFloatField;
    PayrollMasterNSDHrs: TFloatField;
    PayrollMasterUndertimeHrs: TFloatField;
    PayrollMasterAbsencesDays: TFloatField;
    PayrollMasterPremiumDays: TFloatField;
    PayrollMasterTardiHrs: TFloatField;
    PayrollMasterDailyRate: TFloatField;
    PayrollMasteremployeestatus: TStringField;
    PayrollMasterDayPresent: TFloatField;
    PayrollMasterTardi: TFloatField;
    PayrollMasterperMonetize: TFloatField;
    PayrollMasterperLeaveCredits: TFloatField;
    PayrollMasterRegOTRate: TFloatField;
    PayrollMasterSpcOTRate: TFloatField;
    PayrollMasterSpcExOTRate: TFloatField;
    PayrollMasterLegOTRate: TFloatField;
    PayrollMasterLegExOTRate: TFloatField;
    PayrollMasterLegRestOTRate: TFloatField;
    PayrollMasterLegRestExOTRate: TFloatField;
    PayrollMasterisLock: TByteField;
    PayrollMasterDF: TDateTimeField;
    PayrollMasterDT: TDateTimeField;
    PayrollMasterlmabod: TFloatField;
    PayrollMasterprorate: TFloatField;
    PayrollMasterprerate: TFloatField;
    PayrollMasterSpcrestpay: TFloatField;
    PayrollMasterSpcRestHrs: TFloatField;
    PayrollMasterSpcrestOTrate: TFloatField;
    PayrollMasterarea: TStringField;
    Deptiddepartment: TLongWordField;
    Deptdepartmentcode: TStringField;
    Deptdepartmentname: TStringField;
    Deptselecteddepartment: TBooleanField;
    DeptArea: TStringField;
    Companyidcompany: TLongWordField;
    Companycompanyname: TStringField;
    Companyaddress: TStringField;
    Companylogo: TBlobField;
    Companyfilename: TStringField;
    Companycompanyacro: TStringField;
    CompanysssNumber: TStringField;
    CompanyphilHealthNumber: TStringField;
    CompanypagibigNumber: TStringField;
    Companytin: TStringField;
    CompanyZipCode: TStringField;
    CompanyContactNum: TStringField;
    Emp201idemp201: TLongWordField;
    Emp201empnumber: TStringField;
    Emp201date201: TDateField;
    Emp201reference: TStringField;
    Emp201title: TStringField;
    Emp201docpicture: TBlobField;
    Emp201idemployee: TFloatField;
    EmpLeaveidempleavecredits: TLongWordField;
    EmpLeaveidemployee: TFloatField;
    EmpLeaveDatePosted: TDateField;
    EmpLeaveRemarks: TStringField;
    EmpLeaveempnumber: TStringField;
    EmpLeaveLeaveIn: TFloatField;
    EmpLeaveLeaveOut: TFloatField;
    EmpLeaveLeaveDesc: TStringField;
    EmpLeaveEntryType: TByteField;
    EmpLeaveOT: TByteField;
    EmpLeavedescription: TStringField;
    Taxidwtax: TLongWordField;
    Taxwtaxstatus: TStringField;
    Taxdescription: TStringField;
    Taxexemptionamount: TFloatField;
    Taxtaxtabletype: TStringField;
    TaxSchedidwtaxschedule: TLongWordField;
    TaxSchedidwtax: TFloatField;
    TaxSchedwtaxstatus: TStringField;
    TaxSchedrangefrom: TFloatField;
    TaxSchedrangeto: TFloatField;
    TaxSchedfixtax: TFloatField;
    TaxSchedexcesspercent: TFloatField;
    TaxSchedOverTimeMultiplier: TFloatField;
    PMDeductionidpmdeduction: TLongWordField;
    PMDeductionidemployee: TFloatField;
    PMDeductionPaymonth: TDateField;
    PMDeductionempnumber: TStringField;
    PMDeductionname: TStringField;
    PMDeductionfixdeductionindex: TLongWordField;
    PMDeductionloanschedule: TLongWordField;
    PMDeductiondescription: TStringField;
    PMDeductionamount: TFloatField;
    PMDeductionemployeecontribution: TFloatField;
    PMDeductionemployercontribution: TFloatField;
    PMDeductionemployeecompensation: TFloatField;
    PMDeductionpaycode: TStringField;
    PMDeductionpaydesc: TStringField;
    PMDeductionactualremittance: TFloatField;
    Accountchartidaccountchart: TIntegerField;
    Accountchartidchart: TLargeintField;
    Accountchartidemployee: TLargeintField;
    Accountchartdescription: TStringField;
    Accountchartempnumber: TStringField;
    Accountchartaccountcode: TStringField;
    Accountchartaccountname: TStringField;
    Accountchartpaycode: TStringField;
    DepartmentEntryiddepartment: TLongWordField;
    DepartmentEntrydepartmentcode: TStringField;
    DepartmentEntrydepartmentname: TStringField;
    DepartmentEntryselecteddepartment: TBooleanField;
    DepartmentEntryArea: TStringField;
    DescriptionListingidDescriptionListing: TLargeintField;
    DescriptionListingDescription: TStringField;
    DescriptionListingAccountCode: TStringField;
    RankidRankPos: TLargeintField;
    RankRank: TLongWordField;
    RankDescription: TStringField;
    RankBasicPay: TFloatField;
    satsunCntQ: TMyQuery;
    dayOfMonthQ: TMyQuery;
    satsunCntQsatSuntCnt: TLargeintField;
    dayOfMonthQdayNo: TLargeintField;
    CTax_casual: TMyQuery;
    CTax_casualidwtaxschedule: TLongWordField;
    CTax_casualidwtax: TFloatField;
    CTax_casualwtaxstatus: TStringField;
    CTax_casualrangefrom: TFloatField;
    CTax_casualrangeto: TFloatField;
    CTax_casualfixtax: TFloatField;
    CTax_casualexcesspercent: TFloatField;
    CTax_casualOverTimeMultiplier: TFloatField;
    PayrollMastertaxablePartial: TFloatField;
    cpayrollTotalQ: TMyQuery;
    cpayrollTotalQidemployee: TFloatField;
    cpayrollTotalQpaymonth: TStringField;
    cpayrollTotalQdescription: TStringField;
    cpayrollTotalQempnumber: TStringField;
    cpayrollTotalQname: TStringField;
    cpayrollTotalQdeptcode: TStringField;
    cpayrollTotalQbasicpay: TFloatField;
    cpayrollTotalQDifferential: TFloatField;
    cpayrollTotalQUnpaidAmt: TFloatField;
    cpayrollTotalQNumUnpaidDays: TFloatField;
    cpayrollTotalQUnpaidRate: TFloatField;
    cpayrollTotalQpremiumpay: TFloatField;
    cpayrollTotalQSpcOtExPay: TFloatField;
    cpayrollTotalQPAGIBIGCont: TFloatField;
    cpayrollTotalQSSSCont: TFloatField;
    cpayrollTotalQPhilHealth: TFloatField;
    cpayrollTotalQDayPresent: TFloatField;
    cpayrollTotalQundertime: TFloatField;
    cpayrollTotalQTardi: TFloatField;
    cpayrollTotalQWtaxPartial: TFloatField;
    PayrollMasterWTaxPartial: TFloatField;
    updateTaxPartial: TMyQuery;
    ComputeNetPayCas: TMyQuery;
    filterDate: TMyQuery;
    filterDatepaymonth: TDateField;
    procedure LoansCalcFields(DataSet: TDataSet);
    procedure EmpLeaveCalcFields(DataSet: TDataSet);
    procedure DataModuleCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
    Version : String;
  end;

  Const Ver : String = '1.7.5 : 2021-05-12';

var
  PayrollData: TPayrollData;

implementation

uses StrUtils, MaskUtils, ModTools, Math;

{$R *.dfm}

procedure TPayrollData.LoansCalcFields(DataSet: TDataSet);
begin
  Loansloanstatus.Text := 'OL';
  If RoundTo(Loanstotalloan.AsCurrency,0) = RoundTo(Loanstotalpayment.AsCurrency,0) then Loansloanstatus.Text := 'FULLY PAID';
end;

procedure TPayrollData.EmpLeaveCalcFields(DataSet: TDataSet);
begin
  If EmpLeaveLeaveDesc.Text = '1' then EmpLeavedescription.Text := 'VACATION LEAVE';
  If EmpLeaveLeaveDesc.Text = '2' then EmpLeavedescription.Text := 'SICK LEAVE';
  If EmpLeaveLeaveDesc.Text = '3' then EmpLeavedescription.Text := 'SPECIAL LEAVE';
end;

procedure TPayrollData.DataModuleCreate(Sender: TObject);
begin
  Version := Ver;
end;

end.



